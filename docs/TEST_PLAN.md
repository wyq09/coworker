# Coworker 桌面应用测试计划

## 测试用例清单

本文档列出了 Coworker 桌面应用的所有测试用例，包括单元测试、集成测试和 E2E 测试。

---

## 1. 核心功能测试用例

### 1.1 用户认证

#### 单元测试

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| AUTH-001 | 登录表单验证 | 验证邮箱格式、密码长度 | P0 |
| AUTH-002 | 登录状态管理 | 测试登录状态存储和获取 | P0 |
| AUTH-003 | Token 刷新机制 | 测试过期 token 自动刷新 | P0 |
| AUTH-004 | 登出功能 | 测试登出后状态清理 | P0 |
| AUTH-005 | 记住我功能 | 测试持久化登录状态 | P1 |

#### 集成测试

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| AUTH-I001 | Tauri 登录命令调用 | 测试前端与 Rust 后端登录接口 | P0 |
| AUTH-I002 | 错误处理 | 测试登录失败场景（网络错误、认证失败） | P0 |
| AUTH-I003 | 本地存储集成 | 测试用户凭证安全存储 | P0 |

#### E2E 测试

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| AUTH-E001 | 完整登录流程 | 输入凭证 → 提交 → 验证跳转 | P0 |
| AUTH-E002 | 错误提示显示 | 显示服务器返回的错误消息 | P0 |
| AUTH-E003 | 登出流程 | 登出后跳转到登录页 | P0 |

### 1.2 工作区管理

#### 单元测试

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| WS-001 | 工作区数据结构验证 | 验证工作区对象 schema | P0 |
| WS-002 | 工作区列表排序 | 测试按名称、时间排序 | P1 |
| WS-003 | 工作区搜索/过滤 | 测试搜索功能 | P1 |
| WS-004 | 工作区图标显示 | 测试图标加载和回退 | P2 |

#### 集成测试

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| WS-I001 | 创建工作区 | 测试创建工作区 API 调用 | P0 |
| WS-I002 | 加入工作区 | 测试加入工作区流程 | P0 |
| WS-I003 | 工作区数据同步 | 测试实时数据更新 | P0 |

#### E2E 测试

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| WS-E001 | 创建新工作区 | 填写表单 → 创建 → 验证出现在列表 | P0 |
| WS-E002 | 切换工作区 | 选择工作区 → 验证内容切换 | P0 |
| WS-E003 | 工作区设置 | 修改设置 → 保存 → 验证更改 | P1 |

### 1.3 实时协作

#### 单元测试

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| COLLAB-001 | WebSocket 连接状态 | 测试连接状态管理 | P0 |
| COLLAB-002 | 事件监听器 | 测试事件订阅和取消订阅 | P0 |
| COLLAB-003 | 消息队列 | 测试离线消息缓存 | P1 |
| COLLAB-004 | 重连机制 | 测试断线重连逻辑 | P0 |

#### 集成测试

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| COLLAB-I001 | Tauri 事件 API | 测试 Tauri 事件系统 | P0 |
| COLLAB-I002 | 数据同步 | 测试多端数据同步 | P0 |

#### E2E 测试

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| COLLAB-E001 | 实时聊天 | 发送消息 → 验证显示 | P0 |
| COLLAB-E002 | 在线状态 | 显示用户在线/离线状态 | P1 |
| COLLAB-E003 | 通知显示 | 接收通知 → 验证显示 | P0 |

### 1.4 文件操作

#### 单元测试

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| FILE-001 | 文件路径处理 | 测试路径拼接、解析 | P0 |
| FILE-002 | 文件类型检测 | 测试 MIME 类型识别 | P1 |
| FILE-003 | 文件大小格式化 | 测试人类可读格式 | P2 |
| FILE-004 | 上传进度计算 | 测试进度百分比 | P1 |

#### 集成测试

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| FILE-I001 | Tauri 文件对话框 | 测试文件选择 API | P0 |
| FILE-I002 | 文件上传 | 测试文件上传流程 | P0 |
| FILE-I003 | 文件下载 | 测试文件下载功能 | P0 |

#### E2E 测试

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| FILE-E001 | 上传文件 | 选择文件 → 上传 → 验证成功 | P0 |
| FILE-E002 | 下载文件 | 点击下载 → 验证文件保存 | P0 |
| FILE-E003 | 拖拽上传 | 拖拽文件到区域 → 验证上传 | P1 |

---

## 2. UI 组件测试用例

### 2.1 基础组件 (iOS 26 Liquid Glass 风格)

#### Button 组件

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| BTN-001 | 渲染不同变体 | primary, secondary, ghost | P0 |
| BTN-002 | 不同尺寸 | small, medium, large | P1 |
| BTN-003 | 禁用状态 | 点击无响应，样式正确 | P0 |
| BTN-004 | 加载状态 | 显示加载指示器 | P0 |
| BTN-005 | 图标按钮 | 带图标的按钮 | P1 |
| BTN-006 | 点击波纹效果 | Liquid Glass 特效 | P1 |

#### Input 组件

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| INP-001 | 基本输入 | 输入文本 → 验证值更新 | P0 |
| INP-002 | 占位符显示 | 显示和隐藏 | P1 |
| INP-003 | 错误状态 | 显示错误消息 | P0 |
| INP-004 | 禁用状态 | 不可编辑 | P0 |
| INP-005 | 字符计数 | 显示剩余字符 | P1 |
| INP-006 | 密码显示/隐藏 | 切换可见性 | P0 |

#### Modal 组件

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| MOD-001 | 打开/关闭 | 显示和隐藏模态框 | P0 |
| MOD-002 | 点击遮罩关闭 | 点击外部区域关闭 | P0 |
| MOD-003 | ESC 键关闭 | 按键关闭 | P0 |
| MOD-004 | 锁定背景滚动 | 打开时禁止背景滚动 | P1 |
| MOD-005 | 确认/取消操作 | 测试回调 | P0 |

#### Dropdown 组件

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| DRP-001 | 打开/关闭菜单 | 点击切换显示 | P0 |
| DRP-002 | 选择选项 | 点击选项 → 更新值 | P0 |
| DRP-003 | 键盘导航 | 上下键选择 | P1 |
| DRP-004 | 搜索过滤 | 输入过滤选项 | P1 |
| DRP-005 | 多选模式 | 选择多个值 | P1 |

#### Toast 组件

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| TST-001 | 成功消息 | 显示成功 Toast | P0 |
| TST-002 | 错误消息 | 显示错误 Toast | P0 |
| TST-003 | 警告消息 | 显示警告 Toast | P1 |
| TST-004 | 自动消失 | 超时后自动关闭 | P0 |
| TST-005 | 手动关闭 | 点击关闭按钮 | P0 |
| TST-006 | 多条堆叠 | 显示多条 Toast | P1 |

### 2.2 复合组件

#### Sidebar 组件

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| SID-001 | 展开/收起 | 切换侧边栏状态 | P0 |
| SID-002 | 导航项高亮 | 当前页面对应项高亮 | P0 |
| SID-003 | 拖拽调整宽度 | 拖拽改变宽度 | P2 |
| SID-004 | 滚动行为 | 内容溢出时滚动 | P1 |

#### AppBar 组件

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| BAR-001 | 标题显示 | 显示当前页面标题 | P0 |
| BAR-002 | 操作按钮 | 显示操作按钮 | P0 |
| BAR-003 | 面包屑导航 | 显示导航路径 | P1 |
| BAR-004 | 搜索框 | 搜索功能集成 | P1 |

#### List 组件

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| LST-001 | 基本渲染 | 渲染列表项 | P0 |
| LST-002 | 空状态 | 无数据时显示 | P0 |
| LST-003 | 加载状态 | 显示骨架屏 | P0 |
| LST-004 | 虚拟滚动 | 大量数据性能 | P1 |
| LST-005 | 下拉刷新 | 下拉刷新数据 | P1 |
| LST-006 | 上拉加载 | 滚动到底加载更多 | P1 |

---

## 3. 集成测试场景

### 3.1 状态管理

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| STATE-001 | 全局状态初始化 | 应用启动时初始化 | P0 |
| STATE-002 | 状态持久化 | 刷新后恢复状态 | P0 |
| STATE-003 | 多窗口状态同步 | 多窗口状态同步 | P1 |
| STATE-004 | 状态重置 | 登出后清理状态 | P0 |

### 3.2 路由导航

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| ROUTE-001 | 页面跳转 | 点击导航 → 路由变化 | P0 |
| ROUTE-002 | 浏览器前进/后退 | 浏览器导航 | P1 |
| ROUTE-003 | 深度链接 | 直接打开 URL | P1 |
| ROUTE-004 | 路由守卫 | 未登录重定向 | P0 |
| ROUTE-005 | 404 处理 | 不存在的路由 | P1 |

---

## 4. 性能测试用例

| ID | 测试用例名称 | 目标 | 优先级 |
|----|-------------|------|-------|
| PERF-001 | 应用启动时间 | < 2s | P0 |
| PERF-002 | 页面切换响应 | < 100ms | P0 |
| PERF-003 | 大列表渲染 | 1000+ 项流畅滚动 | P1 |
| PERF-004 | 内存使用 | 长时间运行无泄漏 | P0 |
| PERF-005 | CPU 使用 | 空闲时 < 5% | P1 |

---

## 5. 可访问性测试用例

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| A11Y-001 | 键盘导航 | 所有功能可键盘操作 | P0 |
| A11Y-002 | 屏幕阅读器 | ARIA 标签正确 | P0 |
| A11Y-003 | 颜色对比度 | 符合 WCAG AA | P0 |
| A11Y-004 | 焦点管理 | 焦点可见和正确 | P0 |
| A11Y-005 | 文本缩放 | 支持 200% 缩放 | P1 |

---

## 6. 安全测试用例

| ID | 测试用例名称 | 描述 | 优先级 |
|----|-------------|------|-------|
| SEC-001 | XSS 防护 | 转义用户输入 | P0 |
| SEC-002 | 敏感数据存储 | Token 安全存储 | P0 |
| SEC-003 | HTTPS 通信 | 强制使用 HTTPS | P0 |
| SEC-004 | 输入验证 | 服务端验证 | P0 |

---

## 测试执行计划

### 阶段 1: 基础设施 (第 1 周)
- [x] 配置 Vitest
- [x] 配置 Playwright
- [x] 创建测试工具函数
- [x] 创建 Mock 数据

### 阶段 2: 核心功能测试 (第 2-3 周)
- [ ] 用户认证测试
- [ ] 工作区管理测试
- [ ] 实时协作测试
- [ ] 文件操作测试

### 阶段 3: UI 组件测试 (第 4 周)
- [ ] 基础组件测试
- [ ] 复合组件测试
- [ ] iOS 26 Liquid Glass 风格验证

### 阶段 4: 集成测试 (第 5 周)
- [ ] 状态管理集成
- [ ] 路由导航集成
- [ ] Tauri API 集成

### 阶段 5: E2E 测试 (第 6 周)
- [ ] 完整用户流程
- [ ] 跨平台验证 (macOS, Windows, Linux)

---

## 测试覆盖率目标

| 模块 | 目标覆盖率 |
|------|-----------|
| 认证模块 | 85% |
| 工作区模块 | 80% |
| 协作模块 | 75% |
| UI 组件 | 90% |
| 工具函数 | 95% |

---

## 待确认事项

- [ ] 产品经理提供 PRD 文档
- [ ] 设计师提供 UI 设计稿和交互规范
- [ ] 后端 API 文档
- [ ] 确定 CI/CD 流程
- [ ] 确定测试环境配置
